<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Elite Notes - Luxus Jegyzetf√ºzet</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Montserrat:wght@300;400;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 30px;
            padding: 30px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .header { text-align: center; margin-bottom: 40px; }
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 42px;
            background: linear-gradient(135deg, #d4af37 0%, #f4e5c3 50%, #8b6914 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }

        .save-indicator {
            position: fixed; top: 20px; right: 20px; padding: 10px 20px;
            background: #d4af37; color: white; border-radius: 20px;
            opacity: 0; transition: 0.3s; pointer-events: none; z-index: 1000;
        }
        .save-indicator.show { opacity: 1; }

        .notebooks-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px; margin-bottom: 30px;
        }

        .notebook-card {
            background: white; border: 3px solid #d4af37; border-radius: 20px;
            padding: 25px; cursor: pointer; text-align: center; transition: 0.3s;
        }
        .notebook-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(212,175,55,0.2); }

        .note-item {
            background: white; border: 2px solid #d4af37; border-radius: 15px;
            padding: 20px; margin-bottom: 15px; cursor: pointer; display: flex; justify-content: space-between;
        }

        .note-title-input {
            width: 100%; font-size: 22px; border: none; border-bottom: 2px solid #d4af37;
            padding: 15px; margin-bottom: 20px; font-family: inherit; background: transparent;
        }

        .note-text-input {
            width: 100%; min-height: 300px; border: 2px solid #d4af37; border-radius: 15px;
            padding: 20px; font-size: 16px; font-family: inherit; resize: vertical;
        }

        #drawingCanvas {
            width: 100%; height: 500px; border: 2px solid #d4af37; border-radius: 15px;
            background: white; touch-action: none; cursor: crosshair;
        }

        .btn-primary {
            background: linear-gradient(135deg, #d4af37, #8b6914); color: white;
            border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; font-weight: bold;
        }

        .btn-delete { background: #e74c3c; color: white; border: none; padding: 12px 25px; border-radius: 25px; cursor: pointer; }
        
        .back-btn { background: #34495e; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; margin-bottom: 20px; }

        .page { display: none; }
        .page.active { display: block; }

        .editor-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .editor-tab { flex: 1; padding: 10px; border: 1px solid #d4af37; text-align: center; cursor: pointer; border-radius: 10px; }
        .editor-tab.active { background: #d4af37; color: white; }
        .editor-content { display: none; }
        .editor-content.active { display: block; }
        
        .empty-state { text-align: center; padding: 40px; color: #666; }
    </style>
</head>
<body>

    <div class="save-indicator" id="saveIndicator"><span id="saveText">Mentve</span></div>

    <div class="container">
        <div id="notebooksPage" class="page active">
            <div class="header">
                <h1>ELITE NOTES</h1>
                <p>Luxus Digit√°lis Jegyzetf√ºzet</p>
            </div>
            <div class="notebooks-grid" id="notebooksList"></div>
            <button class="btn-primary" onclick="openNewNotebookModal()">+ √öj F√ºzet</button>
        </div>

        <div id="notesPage" class="page">
            <button class="back-btn" onclick="showNotebooksPage()">‚Üê Vissza</button>
            <h2 id="currentNotebookName" style="margin-bottom: 20px;"></h2>
            <div id="notesList"></div>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn-primary" onclick="openNewNoteModal()">+ √öj Jegyzet</button>
                <button class="btn-delete" onclick="deleteNotebook()">F√ºzet t√∂rl√©se</button>
            </div>
        </div>

        <div id="editorPage" class="page">
            <button class="back-btn" onclick="backToNotes()">‚Üê Vissza</button>
            <div class="editor-tabs">
                <div class="editor-tab active" data-type="text" onclick="switchEditorTab('text')">G√©pel√©s</div>
                <div class="editor-tab" data-type="drawing" onclick="switchEditorTab('drawing')">Rajz</div>
            </div>

            <div id="textEditor" class="editor-content active">
                <input type="text" id="noteTitle" class="note-title-input" placeholder="C√≠m...">
                <textarea id="noteText" class="note-text-input" placeholder="√çrj ide valamit..."></textarea>
            </div>

            <div id="drawingEditor" class="editor-content">
                <input type="text" id="drawingTitle" class="note-title-input" placeholder="Rajz c√≠me...">
                <div style="margin-bottom: 10px; display: flex; gap: 5px;">
                    <button onclick="clearCanvas()">T√∂rl√©s</button>
                    <input type="color" id="colorPicker" value="#000000">
                </div>
                <canvas id="drawingCanvas"></canvas>
            </div>

            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn-primary" onclick="saveNote()">Ment√©s</button>
                <button class="btn-delete" onclick="deleteNote()">T√∂rl√©s</button>
            </div>
        </div>
    </div>

    <script>
        let notebooks = JSON.parse(localStorage.getItem('elite_nb')) || [];
        let notes = JSON.parse(localStorage.getItem('elite_notes')) || [];
        let currentNotebookId = null;
        let currentNoteId = null;
        let currentEditorType = 'text';

        // Canvas v√°ltoz√≥k
        let canvas, ctx, isDrawing = false;

        window.onload = () => {
            renderNotebooks();
            initCanvas();
        };

        function saveData() {
            localStorage.setItem('elite_nb', JSON.stringify(notebooks));
            localStorage.setItem('elite_notes', JSON.stringify(notes));
            const ind = document.getElementById('saveIndicator');
            ind.classList.add('show');
            setTimeout(() => ind.classList.remove('show'), 1000);
        }

        function renderNotebooks() {
            const list = document.getElementById('notebooksList');
            if (notebooks.length === 0) {
                list.innerHTML = '<div class="empty-state">Nincs m√©g f√ºzeted.</div>';
                return;
            }
            list.innerHTML = notebooks.map(nb => `
                <div class="notebook-card" onclick="openNotebook('${nb.id}')">
                    <div style="font-size: 40px;">üìí</div>
                    <h3>${nb.name}</h3>
                </div>
            `).join('');
        }

        function openNewNotebookModal() {
            const n = prompt("F√ºzet neve:");
            if (n) {
                notebooks.push({id: 'nb'+Date.now(), name: n});
                saveData(); renderNotebooks();
            }
        }

        function openNotebook(id) {
            currentNotebookId = id;
            const nb = notebooks.find(x => x.id === id);
            document.getElementById('currentNotebookName').textContent = nb.name;
            showPage('notesPage');
            renderNotes();
        }

        function renderNotes() {
            const list = document.getElementById('notesList');
            const filtered = notes.filter(n => n.notebookId === currentNotebookId);
            if (filtered.length === 0) {
                list.innerHTML = '<p>Nincs m√©g jegyzet ebben a f√ºzetben.</p>';
                return;
            }
            list.innerHTML = filtered.map(n => `
                <div class="note-item" onclick="editNote('${n.id}')">
                    <div>
                        <strong>${n.title}</strong><br>
                        <small>${n.type === 'text' ? 'Sz√∂veges' : 'Rajz'}</small>
                    </div>
                    <span>‚ûî</span>
                </div>
            `).join('');
        }

        function openNewNoteModal() {
            currentNoteId = 'n'+Date.now();
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteText').value = '';
            document.getElementById('drawingTitle').value = '';
            clearCanvas();
            showPage('editorPage');
        }

        function editNote(id) {
            const n = notes.find(x => x.id === id);
            currentNoteId = id;
            currentEditorType = n.type;
            if (n.type === 'text') {
                document.getElementById('noteTitle').value = n.title;
                document.getElementById('noteText').value = n.content;
                switchEditorTab('text');
            } else {
                document.getElementById('drawingTitle').value = n.title;
                const img = new Image();
                img.onload = () => ctx.drawImage(img, 0, 0);
                img.src = n.content;
                switchEditorTab('drawing');
            }
            showPage('editorPage');
        }

        function saveNote() {
            const isT = currentEditorType === 'text';
            const noteData = {
                id: currentNoteId,
                notebookId: currentNotebookId,
                title: (isT ? document.getElementById('noteTitle').value : document.getElementById('drawingTitle').value) || 'C√≠m n√©lk√ºl',
                content: isT ? document.getElementById('noteText').value : canvas.toDataURL(),
                type: currentEditorType
            };
            const idx = notes.findIndex(x => x.id === currentNoteId);
            if (idx > -1) notes[idx] = noteData; else notes.push(noteData);
            saveData(); backToNotes();
        }

        function deleteNote() {
            notes = notes.filter(x => x.id !== currentNoteId);
            saveData(); backToNotes();
        }

        function deleteNotebook() {
            if(confirm("Biztos t√∂rl√∂d?")) {
                notebooks = notebooks.filter(x => x.id !== currentNotebookId);
                notes = notes.filter(x => x.notebookId !== currentNotebookId);
                saveData(); showNotebooksPage();
            }
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function switchEditorTab(t) {
            currentEditorType = t;
            document.querySelectorAll('.editor-tab').forEach(tab => tab.classList.toggle('active', tab.dataset.type === t));
            document.getElementById('textEditor').classList.toggle('active', t === 'text');
            document.getElementById('drawingEditor').classList.toggle('active', t === 'drawing');
            if(t === 'drawing') { canvas.width = canvas.parentElement.offsetWidth; }
        }

        function initCanvas() {
            canvas = document.getElementById('drawingCanvas');
            ctx = canvas.getContext('2d');
            const getPos = (e) => {
                const r = canvas.getBoundingClientRect();
                return { x: (e.clientX || e.touches[0].clientX) - r.left, y: (e.clientY || e.touches[0].clientY) - r.top };
            };
            const start = (e) => { isDrawing = true; ctx.beginPath(); const p = getPos(e); ctx.moveTo(p.x, p.y); };
            const move = (e) => { if(!isDrawing) return; const p = getPos(e); ctx.lineTo(p.x, p.y); ctx.strokeStyle = document.getElementById('colorPicker').value; ctx.lineWidth = 2; ctx.stroke(); };
            const end = () => isDrawing = false;
            canvas.onmousedown = start; canvas.onmousemove = move; window.onmouseup = end;
            canvas.ontouchstart = (e) => { e.preventDefault(); start(e); };
            canvas.ontouchmove = (e) => { e.preventDefault(); move(e); };
            canvas.ontouchend = end;
        }

        function clearCanvas() { ctx.clearRect(0,0,canvas.width,canvas.height); }
        function showNotebooksPage() { showPage('notebooksPage'); renderNotebooks(); }
        function backToNotes() { showPage('notesPage'); renderNotes(); }
    </script>
</body>
</html>
